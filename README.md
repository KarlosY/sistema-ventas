# Sistema de Ventas

Este es un proyecto de un sistema de ventas simple construido con Next.js, TypeScript y Supabase. La aplicación sigue principios de arquitectura limpia para separar las preocupaciones del dominio, la aplicación y la infraestructura.

## Tecnologías Utilizadas

- **Framework:** [Next.js](https://nextjs.org) 14+
- **Lenguaje:** [TypeScript](https://www.typescriptlang.org)
- **Backend y Base de Datos:** [Supabase](https://supabase.io)
- **Estilos:** [Tailwind CSS](https://tailwindcss.com)
- **Arquitectura:** Limpia (Dominio, Aplicación, Infraestructura)

## Instalación y Configuración

Sigue estos pasos para levantar el proyecto en un entorno de desarrollo local.

### 1. Clonar el Repositorio

```bash
git clone https://github.com/KarlosY/sistema-ventas.git
cd sistema-ventas
```

### 2. Instalar Dependencias

```bash
npm install
```

### 3. Configurar la Base de Datos en Supabase

1.  Crea un nuevo proyecto en [Supabase](https://supabase.io).
2.  Ve al **SQL Editor** y ejecuta los siguientes scripts para crear las tablas necesarias:

    **Tabla `products`:**
    ```sql
    -- Script para crear la tabla 'products'
    CREATE TABLE public.products (
      id bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      created_at timestamp with time zone NOT NULL DEFAULT now(),
      name text NOT NULL,
      price numeric NOT NULL,
      stock integer NOT NULL
    );
    ```

    **Tabla `sales`:**
    ```sql
    -- Script para crear la tabla 'sales'
    CREATE TABLE public.sales (
      id bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      created_at timestamp with time zone NOT NULL DEFAULT now(),
      total numeric NOT NULL
    );
    ```

    **Tabla `categories`:**
    ```sql
    -- Script para crear la tabla 'categories'
    CREATE TABLE public.categories (
      id bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      created_at timestamp with time zone NOT NULL DEFAULT now(),
      name text NOT NULL UNIQUE
    );
    ```

    **Modificar tabla `products` para añadir categorías:**
    ```sql
    -- Script para añadir la columna category_id a la tabla 'products'
    ALTER TABLE public.products
    ADD COLUMN category_id BIGINT REFERENCES public.categories(id) ON DELETE SET NULL;
    ```

    **Tabla `sale_details`:**
    ```sql
    -- Script para crear la tabla 'sale_details'
    CREATE TABLE public.sale_details (
      id bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      created_at timestamp with time zone NOT NULL DEFAULT now(),
      sale_id bigint NOT NULL REFERENCES public.sales(id) ON DELETE CASCADE,
      product_id bigint NOT NULL REFERENCES public.products(id),
      quantity integer NOT NULL,
      price numeric NOT NULL
    );
    ```

### 4. Configurar las Variables de Entorno

1.  Crea un archivo `.env.local` en la raíz del proyecto.
2.  Añade las credenciales de tu proyecto de Supabase. Las encontrarás en **Project Settings > API**.

    ```env
    NEXT_PUBLIC_SUPABASE_URL=URL_DE_TU_PROYECTO
    NEXT_PUBLIC_SUPABASE_ANON_KEY=TU_ANON_KEY
    ```

### 5. Ejecutar la Aplicación

```bash
npm run dev
```

Abre [http://localhost:3000](http://localhost:3000) en tu navegador para ver la aplicación en funcionamiento.

## Funcionalidades Implementadas

- **Gestión de Productos y Categorías:**
  - Crear, leer, actualizar y eliminar productos.
  - Gestión completa de categorías: crear, asignar a productos y visualizar.
  - Creación dinámica de categorías desde el mismo formulario de producto.
  - Formulario unificado para creación y edición de productos.
- **Registro de Ventas:**
  - Añadir productos a un carrito de compras.
  - Filtrar productos por categoría en la página de ventas para agilizar la búsqueda.
  - Registrar la venta, lo que descuenta el stock de los productos correspondientes.
  - Validación de stock en tiempo real para no vender más de lo disponible.
- **Reportes Avanzados:**
  - Visualizar un historial detallado de todas las ventas realizadas.
  - Resumen de ventas con totales para el día y el mes en curso.
- **Mejoras de UI/UX y Localización:**
  - Notificaciones dinámicas y no intrusivas (toasts) para acciones del usuario.
  - Indicadores de carga (spinners) para operaciones asíncronas.
  - Estados vacíos mejorados en todas las páginas principales.
  - Navegación fluida con botones para volver al inicio.
  - Localización de moneda a Soles Peruanos (S/) en toda la aplicación.

## Licencia

Este proyecto está bajo la Licencia MIT. Consulta el archivo `LICENSE` para más detalles.

---

© 2025 Karlos Berrios - Ykar.NET
